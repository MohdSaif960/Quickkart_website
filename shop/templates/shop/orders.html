{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>My Orders - Ecommerce</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/order.css' %}">
</head>
<body>
<div class="page-wrapper d-flex flex-column min-vh-100">

    <!-- ===== Navbar ===== -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm sticky-top">
      <div class="container-fluid">
        <a class="navbar-brand fw-bold" href="{% url 'home' %}">üõçÔ∏è Quick-Kart</a>
        <div class="mx-auto d-none d-lg-block">
          <span class="navbar-text text-white fw-semibold fs-5">My Orders</span>
        </div>
        <button class="btn btn-outline-light" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasMenu">
          ‚ò∞
        </button>
      </div>
    </nav>

    <!-- Mobile Title -->
    <div class="text-center bg-light py-2 d-lg-none shadow-sm">
      <h5 class="mb-0 fw-bold">My Orders</h5>
    </div>

    <!-- ===== Offcanvas Menu ===== -->
    <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasMenu">
      <div class="offcanvas-header">
        <h5 class="offcanvas-title">Menu</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
      </div>
      <div class="offcanvas-body">
        <ul class="list-unstyled">
          <li><a href="{% url 'home' %}" class="text-decoration-none d-block py-2">Home</a></li>
          <li><a href="{% url 'cart' %}" class="text-decoration-none d-block py-2">Cart</a></li>
          <li><a href="{% url 'profile' %}" class="text-decoration-none d-block py-2">Profile</a></li>
          <li><a href="{% url 'order_list' %}" class="text-decoration-none d-block py-2">My Order</a></li>
          <li><a href="{% url 'logout' %}" class="text-decoration-none d-block py-2 text-danger">Logout</a></li>
        </ul>
      </div>
    </div>

    <!-- ===== Main Content ===== -->
    <main class="flex-fill">
      <div class="container mt-4 mb-4">
          {% if orders %}
              {% for order in orders %}
                  <div class="order-card">
                      <div class="order-header d-flex justify-content-between align-items-center flex-wrap">
                          <div>
                              <span class="fw-bold">Order ID:</span> {{ order.id }} |
                              <span class="fw-bold">Date:</span> {{ order.created_at|date:"d M Y" }} |
                              <span class="fw-bold">Total:</span> ‚Çπ{{ order.total_amount }}
                          </div>
                          <div class="order-status
                              {% if order.status == 'Delivered' %}status-delivered{% endif %}
                              {% if order.status == 'Pending' %}status-pending{% endif %}
                              {% if order.status == 'Shipped' %}status-shipped{% endif %}
                              {% if order.status == 'Cancelled' %}status-cancelled{% endif %}">
                              {{ order.status }}
                          </div>
                      </div>

                      <div class="p-3">
                          <div class="product-summary">
                              {% for item in order.items.all %}
                              <div class="product-item">
                                  <img src="{{ item.product.image.url }}" alt="{{ item.product.name }}">
                                  <span>{{ item.product.name }} (x{{ item.quantity }})</span>
                              </div>
                              {% endfor %}
                          </div>

                          <div class="mb-2">
                              <strong>Delivery Address:</strong> {{ order.address.address_line }}, {{ order.address.city }}, {{ order.address.state }}
                          </div>

                          <div class="mt-2 action-buttons">
                              <a href="{% url 'order_detail' order.id %}" class="btn btn-sm btn-outline-primary">View Details</a>
                              {% if order.status == 'Pending' %}
                                  <a href="#" class="btn btn-sm btn-warning">Cancel Order</a>
                              {% endif %}
                          </div>
                      </div>
                  </div>
              {% endfor %}
          {% else %}
              <div class="alert alert-info text-center">You have no orders yet.</div>
          {% endif %}
      </div>
    </main>

    <!-- ===== Footer ===== -->
    <footer class="bg-dark text-white text-center py-3 mt-auto">
      <p class="mb-0">&copy; 2025 Quick-Kart. All rights reserved.</p>
    </footer>

</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
